{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// У файлі pixabay-api.js зберігай функції для HTTP-запитів.\nimport axios from \"axios\";\n// import {loadMoreBtnStatus} from \"../main.js\";\n// import {loadMoreBtn} from \"../main.js\";\n// import {renderSearchCollection} from \"./render-functions.js\";\n\n\nconst BASE_URL = \"https://pixabay.com\";\nconst ENDPOINT = \"/api/\";\naxios.defaults.baseURL = BASE_URL;\nconst API_KEY = \"45940755-86be6da0f1a4750ab3bd13574\"\n\nexport const params = {\n    key: API_KEY,\n    q: \"\",\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n    page: 1,\n    per_page: 15,\n}\n\nexport async function searchImagesByQuery(query) {\n    try {\n        params.page = 1;\n        const response = await axios.get(ENDPOINT, {params});\n        return response.data;\n    } catch(error) {\n        console.log(error)\n    }\n}\n\nexport async function fetchMoreImages() {\n    try{\n        const response = await axios.get(ENDPOINT, {params});\n        return response.data;\n\n    }catch(error) {\n        console.log(error)\n    }\n}\n\n\n// export function searchImagesByQuery(query) {\n//     const URL = \"https://pixabay.com/api/\";\n//     const API_KEY =\"45940755-86be6da0f1a4750ab3bd13574\";\n\n//     const params = new URLSearchParams({\n//         key: API_KEY,\n//         q: query,\n//         image_type: \"photo\",\n//         orientation: \"horizontal\",\n//         safesearch: true,\n//     });\n\n//     return fetch(`${URL}?${params}`).then((response) => {\n//         if(!response.ok) {\n//             throw new Error(response.status);\n//         }\n//         return response.json();\n//     })\n// }\n\n","// У файлі render-functions.js створи функції для відображення елементів інтерфейсу.\n// { webformatUrl, largeImageUrl, tags, likes, views, comments, downloads}\n\n\nexport function renderSearchCollection(listImages, images) {\n    function imageTemplate({ webformatURL, largeImageURL, tags, likes, views, comments, downloads}) {\n        return  `<li class=\"image-item\">\n        <a href=\"${largeImageURL}\">\n        <img\n        class=\"search-image\"\n        src=\"${webformatURL}\"\n        alt=\"${tags}\" />\n        <table class=\"image-table\">\n            <tr>\n                <th>Likes</th>\n                <th>Views</th>\n                <th>Comments</th>\n                <th>Downloads</th>\n            </tr>\n            <tr>\n                <td>${likes}</td>\n                <td>${views}</td>\n                <td>${comments}</td>\n                <td>${downloads}</td>\n            </tr>\n        </table>\n        </a>\n        </li>`\n    }\n\n    function imagesTemplate(arr) {\n        return arr.map(imageTemplate).join('');\n    };\n    const markup = imagesTemplate(images);\n    listImages.insertAdjacentHTML('beforeend', markup);\n}","// У файлі main.js напиши всю логіку роботи додатка.\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport {searchImagesByQuery} from \"./js/pixabay-api\";\nimport {renderSearchCollection} from \"./js/render-functions\";\nimport {params} from \"./js/pixabay-api\";\nimport {fetchMoreImages} from \"./js/pixabay-api\";\n\nconst form = document.querySelector(\".form\");\nexport const listImages = document.querySelector(\".images\");\nconst contLoader = document.querySelector(\".loader-container\");\nconst loadMoreBtn = document.querySelector(\".load-btn\");\n// loadMoreBtnStatus(\"hide\");\nlet heightScroll;\n\n\nform.addEventListener(\"submit\", handleSuubmit);\n\nasync function handleSuubmit(e) {\n    loadMoreBtnStatus(\"hide\");\n    e.preventDefault();\n    // очищуємо\n    listImages.innerHTML = \" \";\n    // отримуємо дані з форми\n    params.q = form.elements.search.value.trim();\n    // якщо форма пуста - помилка\n    if(params.q === \"\") {\n        loadMoreBtnStatus(\"hide\");\n        iziToast.error({\n            title: ' ',\n            message: 'Sorry, there are no images matching your search query. Please try again!',\n            titleSize: '16px',\n            titleLineHeight: '24px',\n            messageColor: 'white',\n            messageSize: '16px',\n            messageLineHeight: '24px',\n            backgroundColor: '#ef4040',\n            iconColor: '#ffffff',\n            titleColor: '#ffffff',\n            messageColor: '#ffffff',\n            close: false,\n            position: 'topRight',\n        })\n        return;\n    }\n    // відправляємо запит\n    try {\n        params.page = 1;\n\n        const images = await searchImagesByQuery(params.q);\n        // вмикаємо лоадер\n        contLoader.style.display = \"block\";\n        params.page += 1;\n        // якщо немає даних - помилка\n        if(images.hits[0] === undefined) {\n            contLoader.style.display = \"none\";\n            loadMoreBtnStatus(\"hide\");\n            iziToast.error({\n                title: ' ',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                // iconUrl: errorIcon,\n                titleSize: '16px',\n                titleLineHeight: '24px',\n                messageColor: 'white',\n                messageSize: '16px',\n                messageLineHeight: '24px',\n                backgroundColor: '#ef4040',\n                iconColor: '#ffffff',\n                titleColor: '#ffffff',\n                messageColor: '#ffffff',\n                close: false,\n                position: 'topRight',\n            })\n            return;\n        }\n\n        // відправляємо на відбудовування колекції\n        renderSearchCollection(listImages, images.hits);\n        let elem = document.querySelector(\".image-item\");\n        let rect = elem.getBoundingClientRect();\n        heightScroll = rect.height * 2;\n\n    \n        // після відбудовування вимикаємо лоадер і вмикаємо кнопку \"загрузити ще\"\n        contLoader.style.display = \"none\";\n        // отримуємо кількість картинок усього\n        const totalHits = images.totalHits;\n        // рахуємо кількість сторінок з картинками\n        const totalPages = Math.ceil(totalHits / params.per_page)\n        // якщо кількості сторінок не менше, ніж номер поточної сторінки - кнопку ховаємо, \n        // якщо більше - вмикаємо і додаємо слухача подій\n        if(params.page > totalPages) {\n            loadMoreBtnStatus(\"hide\");\n            iziToast.error({\n                title: ' ',\n                message: \"We're sorry, but you've reached the end of search results.\",\n                // iconUrl: errorIcon,\n                titleSize: '16px',\n                titleLineHeight: '24px',\n                messageColor: 'white',\n                messageSize: '16px',\n                messageLineHeight: '24px',\n                backgroundColor: '#ef4040',\n                iconColor: '#ffffff',\n                titleColor: '#ffffff',\n                messageColor: '#ffffff',\n                close: false,\n                position: 'topRight',\n            })\n            return;\n        } else {\n            loadMoreBtnStatus(\"show\");\n            // переходимо на наступну сторінку\n            // додаємо прослуховувача подій на кнопку загрузити ще\n            loadMoreBtn.addEventListener(\"click\", handleMoreImages)\n        }   \n\n        // МОДАЛКА\n        listImages.addEventListener(\"click\", handleClick);\n\n        function handleClick(e) {\n            e.preventDefault()\n            if (e.target.nodeName !== 'IMG') return;\n            const lightbox = new SimpleLightbox('.image-item a', { \n                captionsData: \"alt\",\n            });\n            lightbox .refresh();\n        }\n        form.reset();\n\n    } catch(error) {\n        iziToast.error({\n            title: ' ',\n            message: `${error.name}`,\n            titleSize: '16px',\n            titleLineHeight: '24px',\n            messageColor: 'white',\n            messageSize: '16px',\n            messageLineHeight: '24px',\n            backgroundColor: '#ef4040',\n            iconColor: '#ffffff',\n            titleColor: '#ffffff',\n            messageColor: '#ffffff',\n            close: false,\n            position: 'topRight',\n        })\n        contLoader.style.display = \"none\";\n    }\n}\n\n// прослуховувач подій на кнопці загрузити ще\nasync function handleMoreImages() {\n    try {\n        contLoader.style.display = \"block\";\n        loadMoreBtnStatus(\"disabled\");\n        const moreImages = await fetchMoreImages();\n        params.page += 1;\n        renderSearchCollection(listImages, moreImages.hits);\n        window.scrollBy({\n            top: heightScroll,\n            behavior: \"smooth\",\n          });\n        contLoader.style.display = \"none\";\n        // отримуємо кількість картинок усього\n        const totalHits = moreImages.totalHits;\n        // рахуємо кількість сторінок з картинками\n        const totalPages = Math.ceil(totalHits / params.per_page)\n        if(params.page > totalPages) {\n            loadMoreBtnStatus(\"hide\");\n            iziToast.error({\n                title: ' ',\n                message: \"We're sorry, but you've reached the end of search results.\",\n                // iconUrl: errorIcon,\n                titleSize: '16px',\n                titleLineHeight: '24px',\n                messageColor: 'white',\n                messageSize: '16px',\n                messageLineHeight: '24px',\n                backgroundColor: '#ef4040',\n                iconColor: '#ffffff',\n                titleColor: '#ffffff',\n                messageColor: '#ffffff',\n                close: false,\n                position: 'topRight',\n            })\n            return;\n        } else {\n            loadMoreBtnStatus();\n        }\n    }catch(error) {\n        iziToast.error({\n            title: ' ',\n            message: `${error.name}`,\n            titleSize: '16px',\n            titleLineHeight: '24px',\n            messageColor: 'white',\n            messageSize: '16px',\n            messageLineHeight: '24px',\n            backgroundColor: '#ef4040',\n            iconColor: '#ffffff',\n            titleColor: '#ffffff',\n            messageColor: '#ffffff',\n            close: false,\n            position: 'topRight',\n        })\n    }\n}\n\n\n// -----------------------------\nexport function loadMoreBtnStatus(status) {\n    if (status === \"hide\") {\n        loadMoreBtn.classList.add(\"hide\");\n    } else if(status === \"show\") {\n        loadMoreBtn.classList.remove(\"hide\");\n    } else if(status === \"disable\") {\n        loadMoreBtn.disabled = true;\n    } else {\n        loadMoreBtn.disabled = false;\n    }\n}\n\n\n"],"names":["BASE_URL","ENDPOINT","axios","API_KEY","params","searchImagesByQuery","query","error","fetchMoreImages","renderSearchCollection","listImages","images","imageTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imagesTemplate","arr","markup","form","contLoader","loadMoreBtn","heightScroll","handleSuubmit","e","loadMoreBtnStatus","iziToast","handleClick","SimpleLightbox","totalHits","totalPages","handleMoreImages","moreImages","status"],"mappings":"owBAOA,MAAMA,EAAW,sBACXC,EAAW,QACjBC,EAAM,SAAS,QAAUF,EACzB,MAAMG,EAAU,qCAEHC,EAAS,CAClB,IAAKD,EACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAM,EACN,SAAU,EACd,EAEO,eAAeE,EAAoBC,EAAO,CAC7C,GAAI,CACA,OAAAF,EAAO,KAAO,GACG,MAAMF,EAAM,IAAID,EAAU,CAAC,OAAAG,CAAM,CAAC,GACnC,IACnB,OAAOG,EAAO,CACX,QAAQ,IAAIA,CAAK,CACpB,CACL,CAEO,eAAeC,GAAkB,CACpC,GAAG,CAEC,OADiB,MAAMN,EAAM,IAAID,EAAU,CAAC,OAAAG,CAAM,CAAC,GACnC,IAEnB,OAAMG,EAAO,CACV,QAAQ,IAAIA,CAAK,CACpB,CACL,CCpCO,SAASE,EAAuBC,EAAYC,EAAQ,CACvD,SAASC,EAAc,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,EAAG,CAC5F,MAAQ;AAAA,mBACGL,CAAa;AAAA;AAAA;AAAA,eAGjBD,CAAY;AAAA,eACZE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBASGC,CAAK;AAAA,sBACLC,CAAK;AAAA,sBACLC,CAAQ;AAAA,sBACRC,CAAS;AAAA;AAAA;AAAA;AAAA,cAK1B,CAED,SAASC,EAAeC,EAAK,CACzB,OAAOA,EAAI,IAAIT,CAAa,EAAE,KAAK,EAAE,CAE7C,CAAI,MAAMU,EAASF,EAAeT,CAAM,EACpCD,EAAW,mBAAmB,YAAaY,CAAM,CACrD,CCxBA,MAAMC,EAAO,SAAS,cAAc,OAAO,EAC9Bb,EAAa,SAAS,cAAc,SAAS,EACpDc,EAAa,SAAS,cAAc,mBAAmB,EACvDC,EAAc,SAAS,cAAc,WAAW,EAEtD,IAAIC,EAGJH,EAAK,iBAAiB,SAAUI,CAAa,EAE7C,eAAeA,EAAcC,EAAG,CAQ5B,GAPAC,EAAkB,MAAM,EACxBD,EAAE,eAAc,EAEhBlB,EAAW,UAAY,IAEvBN,EAAO,EAAImB,EAAK,SAAS,OAAO,MAAM,OAEnCnB,EAAO,IAAM,GAAI,CAChByB,EAAkB,MAAM,EACxBC,EAAS,MAAM,CACX,MAAO,IACP,QAAS,2EACT,UAAW,OACX,gBAAiB,OACjB,aAAc,QACd,YAAa,OACb,kBAAmB,OACnB,gBAAiB,UACjB,UAAW,UACX,WAAY,UACZ,aAAc,UACd,MAAO,GACP,SAAU,UACtB,CAAS,EACD,MACH,CAED,GAAI,CA0EA,IAASC,EAAT,SAAqBH,EAAG,CAEpB,GADAA,EAAE,eAAgB,EACdA,EAAE,OAAO,WAAa,MAAO,OAChB,IAAII,EAAe,gBAAiB,CACjD,aAAc,KAC9B,CAAa,EACS,QAAO,CACpB,EAhFD5B,EAAO,KAAO,EAEd,MAAMO,EAAS,MAAMN,EAAoBD,EAAO,CAAC,EAKjD,GAHAoB,EAAW,MAAM,QAAU,QAC3BpB,EAAO,MAAQ,EAEZO,EAAO,KAAK,CAAC,IAAM,OAAW,CAC7Ba,EAAW,MAAM,QAAU,OAC3BK,EAAkB,MAAM,EACxBC,EAAS,MAAM,CACX,MAAO,IACP,QAAS,2EAET,UAAW,OACX,gBAAiB,OACjB,aAAc,QACd,YAAa,OACb,kBAAmB,OACnB,gBAAiB,UACjB,UAAW,UACX,WAAY,UACZ,aAAc,UACd,MAAO,GACP,SAAU,UAC1B,CAAa,EACD,MACH,CAGDrB,EAAuBC,EAAYC,EAAO,IAAI,EAG9Ce,EAFW,SAAS,cAAc,aAAa,EAC/B,wBACI,OAAS,EAI7BF,EAAW,MAAM,QAAU,OAE3B,MAAMS,EAAYtB,EAAO,UAEnBuB,EAAa,KAAK,KAAKD,EAAY7B,EAAO,QAAQ,EAGxD,GAAGA,EAAO,KAAO8B,EAAY,CACzBL,EAAkB,MAAM,EACxBC,EAAS,MAAM,CACX,MAAO,IACP,QAAS,6DAET,UAAW,OACX,gBAAiB,OACjB,aAAc,QACd,YAAa,OACb,kBAAmB,OACnB,gBAAiB,UACjB,UAAW,UACX,WAAY,UACZ,aAAc,UACd,MAAO,GACP,SAAU,UAC1B,CAAa,EACD,MACZ,MACYD,EAAkB,MAAM,EAGxBJ,EAAY,iBAAiB,QAASU,CAAgB,EAI1DzB,EAAW,iBAAiB,QAASqB,CAAW,EAUhDR,EAAK,MAAK,CAEb,OAAOhB,EAAO,CACXuB,EAAS,MAAM,CACX,MAAO,IACP,QAAS,GAAGvB,EAAM,IAAI,GACtB,UAAW,OACX,gBAAiB,OACjB,aAAc,QACd,YAAa,OACb,kBAAmB,OACnB,gBAAiB,UACjB,UAAW,UACX,WAAY,UACZ,aAAc,UACd,MAAO,GACP,SAAU,UACtB,CAAS,EACDiB,EAAW,MAAM,QAAU,MAC9B,CACL,CAGA,eAAeW,GAAmB,CAC9B,GAAI,CACAX,EAAW,MAAM,QAAU,QAC3BK,EAAkB,UAAU,EAC5B,MAAMO,EAAa,MAAM5B,IACzBJ,EAAO,MAAQ,EACfK,EAAuBC,EAAY0B,EAAW,IAAI,EAClD,OAAO,SAAS,CACZ,IAAKV,EACL,SAAU,QACtB,CAAW,EACHF,EAAW,MAAM,QAAU,OAE3B,MAAMS,EAAYG,EAAW,UAEvBF,EAAa,KAAK,KAAKD,EAAY7B,EAAO,QAAQ,EACxD,GAAGA,EAAO,KAAO8B,EAAY,CACzBL,EAAkB,MAAM,EACxBC,EAAS,MAAM,CACX,MAAO,IACP,QAAS,6DAET,UAAW,OACX,gBAAiB,OACjB,aAAc,QACd,YAAa,OACb,kBAAmB,OACnB,gBAAiB,UACjB,UAAW,UACX,WAAY,UACZ,aAAc,UACd,MAAO,GACP,SAAU,UAC1B,CAAa,EACD,MACZ,MACYD,GAEP,OAAMtB,EAAO,CACVuB,EAAS,MAAM,CACX,MAAO,IACP,QAAS,GAAGvB,EAAM,IAAI,GACtB,UAAW,OACX,gBAAiB,OACjB,aAAc,QACd,YAAa,OACb,kBAAmB,OACnB,gBAAiB,UACjB,UAAW,UACX,WAAY,UACZ,aAAc,UACd,MAAO,GACP,SAAU,UACtB,CAAS,CACJ,CACL,CAIO,SAASsB,EAAkBQ,EAAQ,CAClCA,IAAW,OACXZ,EAAY,UAAU,IAAI,MAAM,EAC1BY,IAAW,OACjBZ,EAAY,UAAU,OAAO,MAAM,EAC7BY,IAAW,UACjBZ,EAAY,SAAW,GAEvBA,EAAY,SAAW,EAE/B"}